
#!/bin/bash
input="$1"
awk -F'\t' -v xcol=3 -v ycol=9 '
BEGIN {sumx=0; sumy=0; sumxy=0; sumx2=0; sumy2=0; n=0}
NR>1 {
    x=$xcol; y=$ycol;
    if(x!="" && y!="") {
        sumx+=x; sumy+=y; sumxy+=x*y; sumx2+=x*x; sumy2+=y*y; n++;
    }
}
END {
    num = n*sumxy - sumx*sumy;
    den = sqrt((n*sumx2 - sumx^2)*(n*sumy2 - sumy^2));
    if (den==0) print "undefined"; else printf("%.3f\n", num/den);
}
' "$input"
